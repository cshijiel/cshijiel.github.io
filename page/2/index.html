<!doctype html>
<html class="theme-next use-motion theme-next-mist">
<head>
  

<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />








  <link rel="stylesheet" type="text/css" href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5"/>




<link rel="stylesheet" type="text/css" href="/css/main.css?v=0.4.5.1"/>


    <meta name="description" content="诚信，认真，专注，踏实" />



  <meta name="keywords" content="Java,互联网,NodeJS" />





  <link rel="shorticon icon" type="image/x-icon" href="/favicon.ico?v=0.4.5.1" />


<meta name="description" content="诚信，认真，专注，踏实">
<meta property="og:type" content="website">
<meta property="og:title" content="Roc`s 随想录">
<meta property="og:url" content="http://coderroc.com/page/2/index.html">
<meta property="og:site_name" content="Roc`s 随想录">
<meta property="og:description" content="诚信，认真，专注，踏实">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Roc`s 随想录">
<meta name="twitter:description" content="诚信，认真，专注，踏实">


<script type="text/javascript" id="hexo.configuration">
  var CONFIG = {
    scheme: 'Mist',
    sidebar: 'hide'
  };
</script>

  <title> Roc`s 随想录 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  <!--[if lte IE 8]>
  <div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;margin:0 auto;'>
    <a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode">
      <img src="http://7u2nvr.com1.z0.glb.clouddn.com/picouterie.jpg" border="0" height="42" width="820"
           alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today or use other browser ,like chrome firefox safari."
           style='margin-left:auto;margin-right:auto;display: block;'/>
    </a>
  </div>
<![endif]-->
  



  <div class="container one-column 
   page-home 
">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><h1 class="site-meta">
  <span class="logo-line-before"><i></i></span>
  <a href="/" class="brand" rel="start">
      <span class="logo">
        <i class="icon-next-logo"></i>
      </span>
      <span class="site-title">Roc`s 随想录</span>
  </a>
  <span class="logo-line-after"><i></i></span>
</h1>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu ">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            <i class="menu-item-icon icon-next-home"></i> <br />
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            <i class="menu-item-icon icon-next-categories"></i> <br />
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            <i class="menu-item-icon icon-next-archives"></i> <br />
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            <i class="menu-item-icon icon-next-tags"></i> <br />
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            <i class="menu-item-icon icon-next-about"></i> <br />
            关于
          </a>
        </li>
      

      
      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div id="content" class="content"> 
  <section id="posts" class="posts-expand">
    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2015/07/21/知识记录/Java基础/浅谈HashMap/" itemprop="url">
                浅谈HashMap
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2015-07-21T08:13:30+08:00" content="2015-07-21">
            2015-07-21
          </time>
        </span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分类于
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/Java基础/" itemprop="url" rel="index">
                  <span itemprop="name">Java基础</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
              &nbsp; | &nbsp;
              <a href="/2015/07/21/知识记录/Java基础/浅谈HashMap/#comments" itemprop="discussionUrl">
                <span class="post-comments-count ds-thread-count" data-thread-key="2015/07/21/知识记录/Java基础/浅谈HashMap/" itemprop="commentsCount"></span>
              </a>
            </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <p>导言：</p>
<p>数组在O(1)时间复杂度可以定位元素(读)，但是随机插入元素(写)效率比较低。而链表则相反，随机插入元素效率很高，但是随机读取效率低。</p>
<p>那有没有，读取和插入效率都很高的数据结构呢？</p>
<p>答案当然是有，HashMap就是一种读取和插入效率都很高的数据结构。</p>
<h3 id="基础特性">基础特性</h3><p>HashMap的几个必要的基础特性：</p>
<ul>
<li>hashCode()</li>
<li>KV键值对</li>
<li>数组为基础，辅助以链表的数据结构</li>
</ul>
<p>因为是散列函数，实际的键在数组中是分散存在的，占有一定的比例，如果比例高的时候容易出现键一样值不一样的情况（在该处形成链表），所以有初始容量和加载因子两个参数。</p>
<p>通常，默认加载因子是0.75，这是在时间和空间上的一种折中。</p>
          <div class="post-more-link text-center">
            <a class="btn" href="/2015/07/21/知识记录/Java基础/浅谈HashMap/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2015/04/21/知识记录/Resource-Autowired-Inject/" itemprop="url">
                spring下应用@Resource, @Autowired 和 @Inject注解进行依赖注入的差别
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2015-04-21T17:20:08+08:00" content="2015-04-21">
            2015-04-21
          </time>
        </span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分类于
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/知识记录/" itemprop="url" rel="index">
                  <span itemprop="name">知识记录</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
              &nbsp; | &nbsp;
              <a href="/2015/04/21/知识记录/Resource-Autowired-Inject/#comments" itemprop="discussionUrl">
                <span class="post-comments-count ds-thread-count" data-thread-key="2015/04/21/知识记录/Resource-Autowired-Inject/" itemprop="commentsCount"></span>
              </a>
            </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <h2 id="Overview">Overview</h2><p>When using Spring there’s the choice of 3 annotations for injecting resources with advantages and disadvantages :<br><code>@Autowired</code><br>The original, “proprietary” annotation from Spring. </p>
<ul>
<li>not standard, Spring proprietary </li>
</ul>
<ul>
<li>resolves by type </li>
<li>for optional dependencies<br><code>@Resource</code><br>The  <code>JSR-250</code> annotation </li>
<li>standard dependency injection </li>
</ul>
<ul>
<li>resolves by name, fallback by type </li>
<li>not for optional dependencies<br><code>@Inject</code><br>The  <code>JSR-330</code> annotation </li>
</ul>
<ul>
<li>resolves by type </li>
<li>standard dependency injection </li>
</ul>
<ul>
<li>not for optional dependencies </li>
</ul>
          <div class="post-more-link text-center">
            <a class="btn" href="/2015/04/21/知识记录/Resource-Autowired-Inject/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2015/04/21/知识记录/Java基础/IoC-and-DI/" itemprop="url">
                IoC and DI
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2015-04-21T10:10:32+08:00" content="2015-04-21">
            2015-04-21
          </time>
        </span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分类于
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/Java基础/" itemprop="url" rel="index">
                  <span itemprop="name">Java基础</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
              &nbsp; | &nbsp;
              <a href="/2015/04/21/知识记录/Java基础/IoC-and-DI/#comments" itemprop="discussionUrl">
                <span class="post-comments-count ds-thread-count" data-thread-key="2015/04/21/知识记录/Java基础/IoC-and-DI/" itemprop="commentsCount"></span>
              </a>
            </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <p>IOC：Inversion of Control 控制反转<br>DI:Dependency Injection 依赖注入</p>
<p>控制反转，从字面意思来看，就是控制权又被动变主动，最后又变回被动。</p>
<p>举个例子：<br>你的主管要求你做一件事情，这个时候就存在这么几个过程，</p>
<p>主管命令你做事情（这个时候主动权在主管，你是被动的）</p>
<p>你接到命令做事情（这个时候主题是你，你是主动的，控制权在你手里）</p>
<p>你完成事情（这个时候主题依然是你，控制权在你手里）</p>
<p>报告主管做完事情（主动权又叫交到主管手里了）</p>
<p>上面的整个过程就完成了一次IOC，从上面可以看出，IOC的基本思想是控制权的转换过程。<br>
          <div class="post-more-link text-center">
            <a class="btn" href="/2015/04/21/知识记录/Java基础/IoC-and-DI/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2015/04/20/知识记录/Java基础/handler-picture/" itemprop="url">
                图片裁剪整理
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2015-04-20T23:09:09+08:00" content="2015-04-20">
            2015-04-20
          </time>
        </span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分类于
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/Java基础/" itemprop="url" rel="index">
                  <span itemprop="name">Java基础</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
              &nbsp; | &nbsp;
              <a href="/2015/04/20/知识记录/Java基础/handler-picture/#comments" itemprop="discussionUrl">
                <span class="post-comments-count ds-thread-count" data-thread-key="2015/04/20/知识记录/Java基础/handler-picture/" itemprop="commentsCount"></span>
              </a>
            </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <p>图片裁剪，核心思想是指定<strong>起始点坐标</strong>和相对于起始点坐标的<strong>偏移向量</strong>，这样就可以精确的指定被裁减图片中的一个矩形区域。</p>
<p>核心代码：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">String name = <span class="string">"D:/wiz/1.jpg"</span>;</span><br><span class="line">String subpath = <span class="string">"D:/wiz/2.jpg"</span>;</span><br><span class="line"></span><br><span class="line">ImageInputStream iis = ImageIO.createImageInputStream(<span class="keyword">new</span> FileInputStream(name));</span><br><span class="line">Iterator&lt;ImageReader&gt; it = ImageIO.getImageReadersByFormatName(<span class="string">"jpg"</span>);</span><br><span class="line">ImageReader reader = it.next();</span><br><span class="line">reader.setInput(iis, <span class="keyword">true</span>);</span><br><span class="line">ImageReadParam param = reader.getDefaultReadParam();</span><br><span class="line">Rectangle rect = <span class="keyword">new</span> Rectangle(<span class="number">100</span>, <span class="number">200</span>, <span class="number">320</span>, <span class="number">525</span>);</span><br><span class="line">param.setSourceRegion(rect);</span><br><span class="line">BufferedImage bi = reader.read(<span class="number">0</span>, param);</span><br><span class="line">ImageIO.write(bi, <span class="string">"jpg"</span>, <span class="keyword">new</span> File(subpath));</span><br></pre></td></tr></table></figure></p>
          <div class="post-more-link text-center">
            <a class="btn" href="/2015/04/20/知识记录/Java基础/handler-picture/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2015/04/15/知识记录/Linux基础/shell-echo-style/" itemprop="url">
                shell中echo显示风格
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2015-04-15T11:16:19+08:00" content="2015-04-15">
            2015-04-15
          </time>
        </span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分类于
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/Linux基础/" itemprop="url" rel="index">
                  <span itemprop="name">Linux基础</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
              &nbsp; | &nbsp;
              <a href="/2015/04/15/知识记录/Linux基础/shell-echo-style/#comments" itemprop="discussionUrl">
                <span class="post-comments-count ds-thread-count" data-thread-key="2015/04/15/知识记录/Linux基础/shell-echo-style/" itemprop="commentsCount"></span>
              </a>
            </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <p>自己封装的一个小函数：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echox()&#123;&#10;        if [ $# = 1 ];&#10;        then&#10;&#10;&#60;!-- more --&#62;&#10;&#10;&#10;                echo -e &#34;\033[32m$1\033[0m&#34;&#10;        else&#10;                if [ $1 = &#34;r&#34; ]||[ $1 = &#34;red&#34; ];&#10;                then&#10;                        echo -e &#34;\033[31m$2\033[0m&#34;&#10;                elif [ $1 = &#34;g&#34; ]||[ $1 = &#34;green&#34; ]&#10;                then&#10;                        echo -e &#34;\033[32m$2\033[0m&#34;&#10;                elif [ $1 = &#34;y&#34; ]||[ $1 = &#34;yellow&#34; ]&#10;                then&#10;                        echo -e &#34;\033[33m$2\033[0m&#34;&#10;                elif [ $1 = &#34;g&#34; ]||[ $1 = &#34;green&#34; ]&#10;                then&#10;                        echo -e &#34;\033[34m$2\033[0m&#34;&#10;                else&#10;                        echo -e &#34;\033[35m$2\033[0m&#34;&#10;                fi&#10;        fi&#10;&#125;</span><br></pre></td></tr></table></figure>
          <div class="post-more-link text-center">
            <a class="btn" href="/2015/04/15/知识记录/Linux基础/shell-echo-style/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2015/04/15/知识记录/springmvc-url/" itemprop="url">
                SpringMVC URL传参方式
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2015-04-15T11:04:43+08:00" content="2015-04-15">
            2015-04-15
          </time>
        </span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分类于
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/知识记录/" itemprop="url" rel="index">
                  <span itemprop="name">知识记录</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
              &nbsp; | &nbsp;
              <a href="/2015/04/15/知识记录/springmvc-url/#comments" itemprop="discussionUrl">
                <span class="post-comments-count ds-thread-count" data-thread-key="2015/04/15/知识记录/springmvc-url/" itemprop="commentsCount"></span>
              </a>
            </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><ol>
<li><p>ModalAndView</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="annotation">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloWorldController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@RequestMapping</span>(<span class="string">"/helloWorld"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">helloWorld</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        ModelAndView mav = <span class="keyword">new</span> ModelAndView();</span><br><span class="line">        mav.setViewName(<span class="string">"helloWorld"</span>);<span class="comment">//viewName 视图名称</span></span><br><span class="line">        mav.addObject(<span class="string">"message"</span>, <span class="string">"Hello World!"</span>);<span class="comment">// 往视图传递对象</span></span><br><span class="line">        <span class="keyword">return</span> mav;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在Class级别这是<code>@RequestMapping</code></p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@Controller&#10;@RequestMapping(&#34;/appointments&#34;)&#10;public class AppointmentsController &#123;&#10;&#10;    private final AppointmentBook appointmentBook;&#10;    &#10;    @Autowired&#10;    public AppointmentsController(AppointmentBook appointmentBook) &#123;&#10;        this.appointmentBook = appointmentBook;&#10;    &#125;&#10;&#10;    @RequestMapping(method = RequestMethod.GET)&#10;    public Map&#60;String, Appointment&#62; get() &#123;&#10;        return appointmentBook.getAppointmentsForToday();&#10;    &#125;&#10;&#10;    @RequestMapping(value=&#34;/&#123;day&#125;&#34;, method = RequestMethod.GET)&#10;    public Map&#60;String, Appointment&#62; getForDay(@PathVariable @DateTimeFormat(iso=ISO.DATE) Date day, Model model) &#123;&#10;        return appointmentBook.getAppointmentsForDay(day);&#10;    &#125;&#10;&#10;    @RequestMapping(value=&#34;/new&#34;, method = RequestMethod.GET)&#10;    public AppointmentForm getNewForm() &#123;&#10;        return new AppointmentForm();&#10;    &#125;&#10;&#10;    @RequestMapping(method = RequestMethod.POST)&#10;    public String add(@Valid AppointmentForm appointment, BindingResult result) &#123;&#10;        if (result.hasErrors()) &#123;&#10;            return &#34;appointments/new&#34;;&#10;        &#125;&#10;        appointmentBook.addAppointment(appointment);&#10;        return &#34;redirect:/appointments&#34;;&#10;    &#125;&#10;&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>@PathVirable</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@RequestMapping(value=&#34;/owners/&#123;ownerId&#125;&#34;, method=RequestMethod.GET)&#10;public String findOwner(@PathVariable String ownerId, Model model) &#123;&#10;  Owner owner = ownerService.findOwner(ownerId);  &#10;  model.addAttribute(&#34;owner&#34;, owner);  &#10;  return &#34;displayOwner&#34;; &#10;&#125;&#10;&#10;&#10;@RequestMapping(value=&#34;/owners/&#123;ownerId&#125;&#34;, method=RequestMethod.GET)&#10;public String findOwner(@PathVariable(&#34;ownerId&#34;) String ownerId, Model model) &#123;&#10;  // implementation omitted&#10;&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<blockquote>
<p>待完善…</p>
</blockquote>
</span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2015/04/10/知识记录/MyBatis/" itemprop="url">
                MyBatis
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2015-04-10T16:01:32+08:00" content="2015-04-10">
            2015-04-10
          </time>
        </span>

        

        
          
            <span class="post-comments-count">
              &nbsp; | &nbsp;
              <a href="/2015/04/10/知识记录/MyBatis/#comments" itemprop="discussionUrl">
                <span class="post-comments-count ds-thread-count" data-thread-key="2015/04/10/知识记录/MyBatis/" itemprop="commentsCount"></span>
              </a>
            </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><p><img src="/images/mybatis-logo.png" alt="mybatis-logo"></p>
<h4 id="首先使用MySql（MariaDB）测试">首先使用MySql（MariaDB）测试</h4><p>√测试成功</p>
<h2 id="什么是_MyBatis_？">什么是 MyBatis ？</h2><p>MyBatis 是支持<strong>定制化 SQL</strong>、<strong>存储过程</strong>以及<strong>高级映射</strong>的优秀的持久层框架。MyBatis 避免了几乎所有的 JDBC 代码和手工设置参数以及抽取结果集。MyBatis 使用简单的 <strong>XML</strong> 或<strong>注解</strong>来配置和映射基本体，将接口和 Java 的 POJOs(Plain Old Java Objects,普通的 Java对象)映射成数据库中的记录。</p>
<h2 id="入门">入门</h2><p>###安装<br>想要使用 MyBatis 只需将 mybatis-x.x.x.jar 文件置于 classpath 中。</p>
<p>如果使用 Maven 构建项目，则需将下面的 dependency 置于 pom.xml 中：</p>
<pre><code><span class="tag">&lt;<span class="title">dependency</span>&gt;</span>
  <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span>
  <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span>
  <span class="tag">&lt;<span class="title">version</span>&gt;</span>x.x.x<span class="tag">&lt;/<span class="title">version</span>&gt;</span>
<span class="tag">&lt;/<span class="title">dependency</span>&gt;</span>
</code></pre><h2 id="探究已映射的_SQL_语句">探究已映射的 SQL 语句</h2><p>这里给出一个基于 XML 映射语句的示例，它应该可以满足上述示例中 SqlSession 的调用。</p>
<pre><code><span class="pi">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="doctype">&lt;!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;</span>
<span class="tag">&lt;<span class="title">mapper</span> <span class="attribute">namespace</span>=<span class="value">"org.mybatis.example.BlogMapper"</span>&gt;</span>
  <span class="tag">&lt;<span class="title">select</span> <span class="attribute">id</span>=<span class="value">"selectBlog"</span> <span class="attribute">resultType</span>=<span class="value">"Blog"</span>&gt;</span>
    select * from Blog where id = #{id}
  <span class="tag">&lt;/<span class="title">select</span>&gt;</span>
<span class="tag">&lt;/<span class="title">mapper</span>&gt;</span>
</code></pre><p>插一句：</p>
<pre><code><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">SqlSession</span></span>
</code></pre><p>这个接口设计的太好了，如下</p>
<pre><code>&lt;T&gt; T selectOne(<span class="built_in">String</span> statement, <span class="built_in">Object</span> parameter);
</code></pre><p>根据接收类型选择返回类型。</p>
<p>好，回来，看看里边的其中一条语句：</p>
<pre><code>&lt;mapper <span class="keyword">namespace</span>=<span class="string">"org.mybatis.example.BlogMapper"</span>&gt;
  &lt;<span class="keyword">select</span> id=<span class="string">"selectBlog"</span> resultType=<span class="string">"Blog"</span>&gt;
    <span class="keyword">select</span> * <span class="keyword">from</span> Blog <span class="keyword">where</span> id = <span class="preprocessor">#{id}</span>
  &lt;/<span class="keyword">select</span>&gt;
&lt;/mapper&gt;
</code></pre><p>这个剩余部分具有很好的自解释性。在命名空间“com.mybatis.example.BlogMapper”中定义了一个名为“<code>selectBlog</code>”的映射语句，这样它就允许你使用指定的完全限定名“org.mybatis.example.BlogMapper.selectBlog”来调用映射语句，就像上面的例子中做的那样：</p>
<pre><code><span class="keyword">Blog </span><span class="keyword">blog </span>= (<span class="keyword">Blog) </span>session.<span class="keyword">selectOne("org.mybatis.example.BlogMapper.selectBlog", </span><span class="number">101</span>)<span class="comment">;</span>
</code></pre><p><strong>另一种办法</strong></p>
<p>你可能注意到这和使用完全限定名调用 Java 对象的方法是相似的，之所以这样做是有原因的。这个命名可以直接映射到在命名空间中同名的 Mapper 类，并在已映射的 select 语句中的名字、参数和返回类型匹配成方法。这样你就可以向上面那样很容易地调用这个对应 Mapper 接口的方法。不过让我们再看一遍下面的例子：</p>
<pre><code><span class="keyword">BlogMapper </span>mapper = session.getMapper(<span class="keyword">BlogMapper.class);
</span><span class="keyword">Blog </span><span class="keyword">blog </span>= mapper.<span class="keyword">selectBlog(101);</span>
</code></pre><p>第二种方法有很多优势，首先它不是基于字符串常量的，就会更安全；其次，如果你的 IDE 有<strong>代码补全</strong>功能，那么你可以在有了已映射的 SQL 语句之后利用这个功能。</p>
<p>对于像 BlogMapper 这样的映射器类（Mapper class）来说，还有另一招来处理映射。它们的映射的语句可以不需要用 XML 来做，取而代之的可以是 Java 注解。比如，上面的 XML 示例可被替换如下：</p>
<pre><code><span class="keyword">package</span> org.mybatis.example;
<span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BlogMapper</span> </span>{
  <span class="annotation">@Select</span>(<span class="string">"SELECT * FROM blog WHERE id = #{id}"</span>)
  <span class="function">Blog <span class="title">selectBlog</span><span class="params">(<span class="keyword">int</span> id)</span></span>;
}
</code></pre><p><strong>对于简单语句来说，注解使代码显得更加简洁，然而 Java 注解对于稍微复杂的语句就会力不从心并且会显得更加混乱。</strong>因此，如果你需要做很复杂的事情，那么最好使用 XML 来映射语句。</p>
<h2 id="范围（Scope）和生命周期">范围（Scope）和生命周期</h2><p><strong><code>提示</code> 对象的生命周期和依赖注入框架</strong></p>
<p>依赖注入框架可以创建线程安全的、基于事务的 SqlSession 和映射器（mapper）并将它们直接注入到你的 bean 中，因此可以直接忽略它们的生命周期。如果对如何通过依赖注入框架来使用 MyBatis 感兴趣可以研究一下<code>MyBatis-Spring</code>或 MyBatis-Guice 两个子项目。</p>
<p>###SqlSessionFactoryBuilder</p>
<p>这个类可以被实例化、使用和丢弃，一旦创建了 SqlSessionFactory，就不再需要它了。因此 SqlSessionFactoryBuilder 实例的最佳范围是方法范围（也就是本地方法变量）。你可以重用 SqlSessionFactoryBuilder 来创建多个 SqlSessionFactory 实例，但是最好还是不要让其一直存在以保证所有的 XML 解析资源开放给更重要的事情。</p>
<p>###SqlSessionFactory</p>
<p>SqlSessionFactory 一旦被创建就应该在应用的运行期间一直存在，没有任何理由对它进行清除或重建。使用 SqlSessionFactory 的最佳实践是在应用运行期间不要重复创建多次，多次重建 SqlSessionFactory 被视为一种代码“坏味道（<strong>bad smell</strong>）”。因此 SqlSessionFactory 的最佳范围是应用范围。有很多方法可以做到，最简单的就是使用<strong>单例模式</strong>或者静态单例模式。</p>
<p>###SqlSession</p>
<p>每个线程都应该有它自己的 SqlSession 实例。SqlSession 的实例不是线程安全的，因此是不能被共享的，所以它的最佳的范围是请求或方法范围。绝对不能将 SqlSession 实例的引用放在一个类的静态域，甚至一个类的实例域也不行。也绝不能将 SqlSession 实例的引用放在任何类型的管理范围中，比如 Serlvet 架构中的 HttpSession。如果你现在正在使用一种 Web 框架，要考虑 SqlSession 放在一个和 HTTP 请求对象相似的范围中。</p>
<blockquote>
<p><strong>换句话说，每次收到的 HTTP 请求，就可以打开一个 SqlSession；返回一个响应，就关闭它。</strong></p>
</blockquote>
<p>这个关闭操作是很重要的，你应该把这个关闭操作放到 finally 块中以确保每次都能执行关闭。下面的示例就是一个确保 SqlSession 关闭的标准模式：</p>
<pre><code>SqlSession session = sqlSessionFactory.openSession();
<span class="keyword">try</span> {
  <span class="comment">// do work</span>
} <span class="keyword">finally</span> {
  session.close();
}
</code></pre><p>你应该在你的所有的代码中<strong>一致性地使用这种模式</strong>来保证所有数据库资源都能被正确地关闭。</p>
<h2 id="问题">问题</h2><ul>
<li>MyBatis运行流程</li>
<li>MyBatis缓存机制</li>
</ul>
<h2 id="参考资料">参考资料</h2><p><a href="http://sishuok.com/forum/blogPost/list/3899.html" target="_blank" rel="external">Mybatis原理分析一 从JDBC到Mybaits </a><a href="http://sishuok.com/forum/blogPost/list/3899.html" target="_blank" rel="external">http://sishuok.com/forum/blogPost/list/3899.html</a></p>
</span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2015/04/09/思维改变生活/how-to-grow-up-quickly/" itemprop="url">
                怎样，才能更快的成长？
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2015-04-09T22:47:33+08:00" content="2015-04-09">
            2015-04-09
          </time>
        </span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分类于
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/思维改变生活/" itemprop="url" rel="index">
                  <span itemprop="name">思维改变生活</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
              &nbsp; | &nbsp;
              <a href="/2015/04/09/思维改变生活/how-to-grow-up-quickly/#comments" itemprop="discussionUrl">
                <span class="post-comments-count ds-thread-count" data-thread-key="2015/04/09/思维改变生活/how-to-grow-up-quickly/" itemprop="commentsCount"></span>
              </a>
            </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><h2 id="精力有限">精力有限</h2><p>首先，<strong>精力有限，所以要针对性的努力</strong>。精力在很大一部分就体现在时间上，我们每个人每天就24小时（最近的一则新闻真的很吓人），当然不可能24小时都在工作，除去必须花费的“日常开销”，洗漱、洗衣、交通、吃饭、睡觉还可能会走神等等之外，剩余时间其实不多了。对，那些必须花费的时间也可以称作“暗时间”，可以参考刘未鹏的博文<a href="http://mindhacks.cn/2009/12/20/dark-time/" target="_blank" rel="external">暗时间</a>。</p>
<h2 id="效率需要提高">效率需要提高</h2><p>有的时候，我们可能会花掉很长的时间，但是可能收获却不怎么大。那是为什么呢？<br>我感觉这个公式比较有说服力</p>
<pre><code><span class="attribute">W</span>=<span class="string">PT</span>
</code></pre><p>换言之，也就是</p>
<pre><code><span class="attribute">成果</span>=<span class="string">效率*时间</span>
</code></pre><p><strong>时间和效率</strong>都要到位才会产生最大的能量。</p>
<h2 id="选择">选择</h2><p>很多人说，选择大于努力。在一定程度上是这样的，但是不要太注重选择，选择的心思花的多了，就会容易投机，投机无论取得多大的成就，我总是感觉不靠谱。</p>
<p>适当选择，把心思主要花在正事上。</p>
<h2 id="合理的计划">合理的计划</h2><p>制定合理的计划，修正计划等。</p>
<p><strong>可以专门的写个网页来记录</strong>，督促自己来完成。</p>
<h2 id="素养、习惯和精神">素养、习惯和精神</h2><p>在面试的时候，有很多面试官喜欢问，看没有看过源代码，这个是怎么实现的等比较本质的东西。<br>对，本质永不落伍，本质才是最重要的，反映某些编程思想的所在。</p>
</span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2015/04/07/知识记录/Node.js/Node.js 的一些零碎知识/" itemprop="url">
                Node.js 的一些零碎知识
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2015-04-07T00:20:36+08:00" content="2015-04-07">
            2015-04-07
          </time>
        </span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分类于
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/Node-js/" itemprop="url" rel="index">
                  <span itemprop="name">Node.js</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
              &nbsp; | &nbsp;
              <a href="/2015/04/07/知识记录/Node.js/Node.js 的一些零碎知识/#comments" itemprop="discussionUrl">
                <span class="post-comments-count ds-thread-count" data-thread-key="2015/04/07/知识记录/Node.js/Node.js 的一些零碎知识/" itemprop="commentsCount"></span>
              </a>
            </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><h3 id="1-_NPM">1. NPM</h3><p>npm 全称是 Node Package Manager，相当于Java世界中的Maven。</p>
<p>操作办法，首先确认安装了node.js和npm模块，然后在node项目文件夹创建package.json，执行npm install会安装（npm install xxx）package内包含的库。例如：</p>
<pre><code>{
  "<span class="attribute">name</span>": <span class="value"><span class="string">"ShareConnect"</span></span>,
  "<span class="attribute">version</span>": <span class="value"><span class="string">"0.0.0"</span></span>,
  "<span class="attribute">private</span>": <span class="value"><span class="literal">true</span></span>,
  "<span class="attribute">scripts</span>": <span class="value">{
    "<span class="attribute">start</span>": <span class="value"><span class="string">"node ./bin/www"</span>
  </span>}</span>,
  "<span class="attribute">dependencies</span>": <span class="value">{
    "<span class="attribute">body-parser</span>": <span class="value"><span class="string">"~1.12.0"</span></span>,
    "<span class="attribute">cookie-parser</span>": <span class="value"><span class="string">"~1.3.4"</span></span>,
    "<span class="attribute">debug</span>": <span class="value"><span class="string">"~2.1.1"</span></span>,
    "<span class="attribute">ejs</span>": <span class="value"><span class="string">"~2.3.1"</span></span>,
    "<span class="attribute">express</span>": <span class="value"><span class="string">"~4.12.2"</span></span>,
    "<span class="attribute">morgan</span>": <span class="value"><span class="string">"~1.5.1"</span></span>,
    "<span class="attribute">serve-favicon</span>": <span class="value"><span class="string">"~2.2.0"</span></span>,
    "<span class="attribute">uuid-js</span>": <span class="value"><span class="string">"~0.7.5"</span></span>,
    "<span class="attribute">redis</span>": <span class="value"><span class="string">"~0.12.1"</span></span>,
    "<span class="attribute">connect</span>": <span class="value"><span class="string">"~2.9.0"</span>
  </span>}
</span>}
</code></pre><p>还有这样一篇文章：<a href="http://www.infoq.com/cn/articles/msh-using-npm-manage-node.js-dependence" target="_blank" rel="external">如何使用NPM来管理你的Node.js依赖</a></p>
<h3 id="2-_项目结构">2. 项目结构</h3><p>MVC分层结构经久考验，在此之上沉淀的技术资源也很丰富，Node.js同样可以设计出优雅高效的分层结果。</p>
<p>Connet中间件在MVC中合理的使用。</p>
<blockquote>
<p>借助Connect可以自由定制中间件的优势，可以自行提升性能或是设计出适合自己需要的项目。Connect自身提供了路由功能，在此基础上，可以轻松搭建MVC模式的框架，以达到开发效率和执行效率的平衡。以下是笔者项目中采用的目录结构，清晰地划分目录结构可以帮助划分代码的职责，此处仅供参考。</p>
</blockquote>
<pre><code>├── Makefile <span class="comment">// 构建文件，通常用于启动单元测试运行等操作</span>
├── app<span class="class">.js</span> <span class="comment">// 应用文件</span>
├── automation  <span class="comment">// 自动化测试目录</span>
├── bin  <span class="comment">// 存放启动应用相关脚本的目录</span>
├── conf  <span class="comment">// 配置文件目录</span>
├── controllers  <span class="comment">// 控制层目录------------------------C，Controller，控制器</span>
├── helpers  <span class="comment">// 帮助类库</span>
├── middlewares  <span class="comment">// 自定义中间件目录</span>
├── models  <span class="comment">// 数据层目录-----------------------------M，Model，模型</span>
├── node_modules  <span class="comment">// 第三方模块目录</span>
├── package<span class="class">.json</span>  <span class="comment">// 项目包描述文件</span>
├── public  <span class="comment">// 静态文件目录</span>
│   ├── images  <span class="comment">// 图片目录</span>
│   ├── libs  <span class="comment">// 第三方前端JavaScript库目录</span>
│   ├── scripts  <span class="comment">// 前端JavaScript脚本目录</span>
│   └── styles  <span class="comment">// 样式表目录</span>
├── test  <span class="comment">// 单元测试目录</span>
└── views  <span class="comment">// 视图层目录-----------------------------V，View，视图</span>
</code></pre><h3 id="3-_关于本项目基本的设计">3. 关于本项目基本的设计</h3><p>可以一个图来解释：<br><img src="http://note.wiz.cn/api/document/files/unzip/66e5c3f6-8482-11e1-a525-00237def97cc/6d3b0fec-73aa-4846-a15d-ff78e296af74.32632/index_files/f76767cb-d24f-4ef4-a718-cc3264db2dde.png" alt="UDP-返回-Post-set"></p>
</span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2015/04/07/知识记录/Java基础/java多线程中的volatile/" itemprop="url">
                java多线程中的volatile
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2015-04-07T00:20:36+08:00" content="2015-04-07">
            2015-04-07
          </time>
        </span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分类于
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/Java基础/" itemprop="url" rel="index">
                  <span itemprop="name">Java基础</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
              &nbsp; | &nbsp;
              <a href="/2015/04/07/知识记录/Java基础/java多线程中的volatile/#comments" itemprop="discussionUrl">
                <span class="post-comments-count ds-thread-count" data-thread-key="2015/04/07/知识记录/Java基础/java多线程中的volatile/" itemprop="commentsCount"></span>
              </a>
            </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><blockquote>
<p><strong>volatile：</strong><br>英[‘vɒlətaɪl] 美[ˈvɑlətl, -ˌtaɪl]<br>adj. 易变的，不稳定的;（液体或油）易挥发的;爆炸性的;快活的，轻快的<br>[例句]A volatile political system makes these reforms hard to achieve.<br>而反复无常的政治体系又让这些方面的改革无法实施。<br>–xx翻译</p>
</blockquote>
<h1 id="一、volatile简述">一、volatile简述</h1><p>Java 语言提供了一种稍弱的同步机制,即 volatile 变量.用来确保将变量的更新操作通知到其他线程,保证了新值能立即同步到主内存,以及每次使用前立即从主内存刷新. 当把变量声明为volatile类型后,编译器与运行时都会注意到这个变量是共享的.</p>
<h1 id="二、_volatile线程安全？">二、 volatile线程安全？</h1><p>volatile 变量对所有线程是立即可见的,对 volatile 变量所有的写操作都能立即反应到其他线程之中,换句话说:volatile 变量在各个线程中是一致的,所以基于 volatile 变量的运算是线程安全的.  </p>
<p>这句话论据貌似没有错,论点确实错的.</p>
<h1 id="三、_valotile_为什么是线程不安全的？">三、 valotile 为什么是线程不安全的？</h1><pre><code><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">VolatileTest</span>{

    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">volatile</span> <span class="keyword">int</span>  i;

    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">increase</span>(<span class="params"></span>)</span>{
        i++;
    }
}
</code></pre><p>编译（<code>javap -c -l VolatileTest.class</code>）后，</p>
<pre><code><span class="keyword">public</span> <span class="keyword">class</span> VolatileTest {
  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">volatile</span> <span class="keyword">int</span> i;

  <span class="function"><span class="keyword">public</span> <span class="title">VolatileTest</span><span class="params">()</span></span>;
    Code:
       <span class="number">0</span>: aload_0       
       <span class="number">1</span>: invokespecial <span class="preprocessor">#<span class="number">1</span>                  <span class="comment">// Method java/lang/Object."&lt;init&gt;":()V</span></span>
       <span class="number">4</span>: <span class="keyword">return</span>        
    LineNumberTable:
      line <span class="number">1</span>: <span class="number">0</span>

  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">increase</span><span class="params">()</span></span>;
    Code:
       <span class="number">0</span>: getstatic     <span class="preprocessor">#<span class="number">2</span>                  <span class="comment">// Field i:I, 把i的值取到了操作栈顶,volatile保证了i值此时是正确的. </span></span>
       <span class="number">3</span>: iconst_1      
       <span class="number">4</span>: iadd                              <span class="comment">// increase,但其他线程此时可能已经把i值加大了好多</span>
       <span class="number">5</span>: putstatic     <span class="preprocessor">#<span class="number">2</span>                  <span class="comment">// Field i:I ,把这个已经out of date的i值同步回主内存中,i值被破坏了.</span></span>
       <span class="number">8</span>: <span class="keyword">return</span>        
    LineNumberTable:
      line <span class="number">6</span>: <span class="number">0</span>
      line <span class="number">7</span>: <span class="number">8</span>
}
</code></pre><p>从这个角度说 volatile 并不完全是线程安全的.</p>
<h1 id="四、_常见的用法">四、 常见的用法</h1><p>在Java内存模型中，有main memory，每个线程也有自己的memory (例如寄存器)。为了性能，一个线程会在自己的memory中保持要访问的变量的副本。这样就会出现同一个变量在某个瞬间，在一个线程的memory中的值可能与另外一个线程memory中的值，或者main memory中的值不一致的情况。<br>一个变量声明为volatile，就意味着这个变量是随时会被其他线程修改的，因此不能将它cache在线程memory中。以下例子展现了volatile的作用：</p>
<pre><code><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StoppableTask</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>{
    <span class="keyword">private</span> <span class="keyword">volatile</span> <span class="keyword">boolean</span> pleaseStop;

    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>{
        <span class="keyword">while</span> (!pleaseStop) {
            <span class="comment">// do some stuff...</span>
        }
    }

    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">tellMeToStop</span><span class="params">()</span> </span>{
        pleaseStop = <span class="keyword">true</span>;
    }
}
</code></pre><p>假如pleaseStop没有被声明为volatile，线程执行run的时候检查的是自己的副本，就不能及时得知其他线程已经调用tellMeToStop()修改了pleaseStop的值。 </p>
<p>Volatile一般情况下不能代替sychronized，因为volatile不能保证操作的原子性，即使只是i++，实际上也是由多个原子操作组成：read i; inc; write i，假如多个线程同时执行i++，volatile只能保证他们操作的i是同一块内存，但依然可能出现写入脏数据的情况。如果配合Java 5增加的atomic wrapper classes，对它们的increase之类的操作就不需要sychronized。 </p>
</span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/">&laquo;</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/3/">&raquo;</a>
  </nav>

 </div>

        

        
      </div>

      
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      <section class="site-overview">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" src="/photo.jpg" alt="Coder_Roc" itemprop="image"/>
          <p class="site-author-name" itemprop="name">Coder_Roc</p>
        </div>
        <p class="site-description motion-element" itemprop="description">诚信，认真，专注，踏实</p>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">48</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          <div class="site-state-item site-state-categories">
            <a href="/categories">
              <span class="site-state-item-count">10</span>
              <span class="site-state-item-name">分类</span>
              </a>
          </div>

          <div class="site-state-item site-state-tags">
            <a href="/tags">
              <span class="site-state-item-count">63</span>
              <span class="site-state-item-name">标签</span>
              </a>
          </div>

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/cshijiel" target="_blank">github</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/cshijiel" target="_blank">weibo</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.zhihu.com/people/cshijiel" target="_blank">zhihu</a>
              </span>
            
          
        </div>

        
        

        <div class="links-of-author motion-element">
          
        </div>

      </section>

      

    </div>
  </aside>


    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner"> <div class="copyright" >
  
  &copy; &nbsp;  2014 - 
  <span itemprop="copyrightYear">2015</span>
  <span class="with-love">
    <i class="icon-next-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Coder_Roc</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>


 </div>
    </footer>

    <div class="back-to-top"></div>
  </div>

  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  
  
    

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"usee"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>
    
     

    
  
  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/fancy-box.js?v=0.4.5.1"></script>


  <script type="text/javascript" src="/js/helpers.js?v=0.4.5.1"></script>
  

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/js/motion_global.js?v=0.4.5.1" id="motion.global"></script>




  <script type="text/javascript" src="/js/nav-toggle.js?v=0.4.5.1"></script>
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  

  <script type="text/javascript">
    $(document).ready(function () {
      if (CONFIG.sidebar === 'always') {
        displaySidebar();
      }
      if (isMobile()) {
        FastClick.attach(document.body);
      }
    });
  </script>

  

  
  

  
  <script type="text/javascript" src="/js/lazyload.js"></script>
  <script type="text/javascript">
    $(function () {
      $("#posts").find('img').lazyload({
        placeholder: "/images/loading.gif",
        effect: "fadeIn"
      });
    });
  </script>
</body>
</html>
